.. _AtoZDCIP_3DInversion:


3D Inversion
============

.. figure:: ./../../../images/AtoZ_Mag/AtoZ_Mag_Landing.png
    :align: right
    :figwidth: 50%

Purpose
^^^^^^^

In this section, we will invert the :ref:`simulated data <AtoZdcip_Forward>` in 3D with three strategies:

- :ref:`Unconstrained inversion <AtoZDCIP_3D_Unconstrained>`
- :ref:`Sensitivity weighted inversion <AtoZDCIP_3D_SensWeights>`
- :ref:`Inversion with 2D starting model <AtoZDCIP_3D_2DStart>`


.. note:: Link to `DCIP3D documentation <http://mvi.readthedocs.io/en/latest/>`_

Downloads
^^^^^^^^^

.. example::    - `Download the demo <https://github.com/ubcgif/GIFtoolsCookbook/raw/master/assets/AtoZ_DCIP_4Download.zip>`_
                    - Requires at least `GIFtools version 2.26 (Oct 2017) <https://gif.eos.ubc.ca/giftools/giftools_consortium2#Installation>`_
                    - Requires `DCIP v5 <https://gif.eos.ubc.ca/giftools>`_


Step by step
^^^^^^^^^^^^

.. tip:: If you have already completed either the :ref:`Survey Design and Simulation
         <AtoZDCIP_simulation>` or the :ref:`2D Inversion
         <AtoZDCIP_2DInversion>` demo, you may advance directly to the :ref:`Unconstrained Inversion Section <AtoZDCIP_3D_Unconstrained>`

- **Step 1: Setup**
    - :ref:`Start a GIFtools project <basicFunctionality_index>`
    - :ref:`Set the working directory <projSetWorkDir>`
    - :ref:`Import the topography data <importTopo>`

- **Step 2: Survey and Data**
    - :ref:`Import the DC data in UBC format <importDCIP3Ddata>`


.. _AtoZDCIP_3D_Unconstrained:

Unconstrained Inversion
^^^^^^^^^^^^^^^^^^^^^^^

As a first step, we invert the :ref:`simulated data <AtoZdcip_Forward>` with a purely unconstrained approach.

- :ref:`Create an inversion object (DC3Dinversion) <createDCIPInv>`
    - :ref:`Edit the options <invEditOptions_dcip3d>`
        - Panel 2: Adjust :math:`\alpha` parameters: :math:`\alpha_s=0.0025, \alpha_x=\alpha_z=1`
        - Click *Apply and write files*
    - :ref:`Run the inversion <>`


.. figure:: ./../../../images/AtoZ_DCIP/AtoZ_DCIP_Unconstrained.png
    :align: center
    :figwidth: 75%



.. _AtoZDCIP_3D_SensWeights:

Sensitivity weighted inversion
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

The result obtained with the unconstrained approach appears to be dominated by
the source-receiver position, with most of the conductivity anomalies
recovered near the survey lines. In order to reduce this geometric bias, we
will incorporate sensitivity-based weights.

- :ref:`Copy the inversion object from the previous example <invCopyOptions>`
- :ref:`Load the sensitivity file <importModelCellCentered>` generated by ``DCINV3D``
- :ref:`Create sensitivity weight <invDCIP3DCreateSensWeights>`
- :ref:`Write All <invWriteAll>` and :ref:`Run <invRun>`


.. figure:: ./../../../images/AtoZ_DCIP/AtoZ_DCIP_SensWeighted.png
    :align: center
    :figwidth: 75%



.. _AtoZDCIP_3D_2DStart:

Inversion with 2D starting model
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^


.. figure:: ./../../../images/AtoZ_DCIP/AtoZ_DCIP_Started2D.png
    :align: center
    :figwidth: 75%
